import flet as ft
from datetime import datetime


def main(page:ft.Page):
    page.title = "мое первое приложение"
    page.theme_mode = ft.ThemeMode.LIGHT

    greeting_text = ft.Text("Привет, мир")
    name_input = ft.TextField("Введите имя")
    history = ft.Column

    def greeting(name:str) -> str:
        """Определяем приветствие по времини суток.""" 
        hour = datetime.now().hour
        if 6 <= hour < 12:
            return f"Доброе утро, {name}"
        elif 12 <= hour < 18:
            return f"Добрый день, {name}"
        elif 18 <= hour < 24:
            return f"Добрый вечер, {name}"
        else:
            return f"Доброй ночи, {name}"
        
    def on_button_click(_):
        name = name_input.value.strip()
        if name:
            greeting_text.value = greeting
            now = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
            history.controls.append(ft.Text(f"{now} - {name}"))
        else:
            greeting_text.value = ("Пожалуйста введите имя")
        page.update
    
    greet_button = ft.ElevatedButton("Поздороваться", on_click=on_button_click)
    
    page.add(greeting_text, name_input, greet_button, history)

ft.app(target=main, view=ft.WEB_BROWSER)